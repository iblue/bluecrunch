18+0i
2.0+0.0i
1.9999999999999998-2.0i
2.0+2.0i
2.0-0.5857864376269051i
1.9999999999999996-3.414213562373095i
2.0+3.414213562373095i
1.9999999999999998+0.5857864376269051i
1.351153302357085+10.054678984251696i
-0.17958042710327482-0.39782473475931646i
5.261972627395669+1.3363572758385973i
1.5664544973505212-2.993211525330978i
1.5664544973505223+2.9932115253309783i
5.261972627395668-1.3363572758385986i
-0.17958042710327426+0.39782473475931557i
1.3511533023570825-10.054678984251694i
11.887873666745605+10.418467108472115i
1.0844131172136953+0.7186040760719754i
4.748914736297005-1.1075571546396843i
-0.06434727076392699-0.37265978041202513i
4.001555774246408+1.7401810493323713i
3.947927431344943-3.0169497032465267i
0.21108876034386403+2.3956046068708208i
-1.817426215427595-2.775690202449045i
-1.8174262154275949+2.775690202449047i
0.21108876034386426-2.3956046068708208i
3.9479274313449437+3.0169497032465267i
4.001555774246407-1.7401810493323722i
-0.06434727076392655+0.37265978041202663i
4.748914736297005+1.1075571546396827i
1.0844131172136962-0.7186040760719754i
11.887873666745605-10.418467108472115i

---

15+0i
3.0+0.0i
3.0+2.0i
3.0-2.0i
5.414213562373096+7.242640687119285i
2.5857864376269046-1.2426406871192848i
2.5857864376269055+1.2426406871192857i
5.414213562373094-7.242640687119286i
11.582205338334969+6.499813138042574i
2.6604353487843158-0.25717245092329i
3.1957049920025717+1.808830921755325i
2.5616543208781426-4.05147160887461i
2.5616543208781435+4.0514716088746106i
3.1957049920025717-1.808830921755325i
2.6604353487843158+0.25717245092329044i
11.582205338334969-6.499813138042576i

FFT:
15      -7
-2-1i -2+1i

15    = 1+5+3+6
-7    = 1-5+3-6
-2-1i = 1+5i-3-6i = -2-1i
-2+1i = 1-5i-3+6i = -2+1i

Got/Expected:
 15     -3
-4-3i -4+3i

Input:
1 5
3 6

1st pass: (+, -)
row    col
6 -4   4  11
9 -3  -2  -1

Transpose:
 6 9    4 -2
-4 -3  11 -1
 row    col

twiddle:
 6 9      4 -2
-4 -3i   11 -1i
 row      col

2nd pass (+, -)
    15 -3        15  -2-1i
 -4-3i -4+3i     -7  -2+1i
  row              col

Correct: col

But shit for access patterns. Input data needs to be transposed or accessed in strides.

=== FFT ===

602+0i
-26.0+0.0i
-40.0+12.0i
-40.0-12.0i
-1.6152236891497687-95.94112549695429i
-38.38477631085024-28.058874503045715i
-38.38477631085024+28.058874503045722i
-1.6152236891497544+95.94112549695427i
-13.4175611908862-72.07110882122315i
15.358686687840478+26.33099345104553i
5.460959333083977+16.61324993933122i
-71.40208483003825+45.1268654308464i
-71.40208483003826-45.126865430846394i
5.460959333083977-16.61324993933122i
15.358686687840473-26.33099345104554i
-13.417561190886188+72.07110882122315i
-24.451031252500375-115.4254874198877i
-11.999095896021043-16.19746546561725i
-3.1721327669473336-47.11460117328154i
32.19080241039255+35.54159456589316i
13.534937590299656+24.705619530444125i
-16.964489054325412-5.233188232227514i
-58.791472918834785-38.557395539863066i
-58.347518112063256+34.2809237345398i
-58.34751811206328-34.28092373453979i
-58.791472918834764+38.55739553986307i
-16.964489054325398+5.233188232227533i
13.534937590299636-24.705619530444142i
32.19080241039252-35.54159456589319i
-3.172132766947298+47.11460117328157i
-11.999095896021068+16.197465465617263i
-24.451031252500336+115.4254874198877i

=== Baileys ===
602.0+0.0i
-26.0+0.0i
-40.0+12.0i
-40.0-12.0i
-1.6152236891497687-95.94112549695429i
-38.38477631085024-28.058874503045715i
-38.38477631085024+28.058874503045722i
-1.6152236891497544+95.94112549695427i
-13.417561190886202-72.07110882122316i
15.35868668784048+26.330993451045536i
5.460959333083984+16.61324993933122i
-71.40208483003826+45.1268654308464i
-71.40208483003826-45.12686543084639i
5.460959333083963-16.61324993933122i
15.358686687840473-26.330993451045536i
-13.41756119088618+72.07110882122313i
-24.45103125250037-115.4254874198877i
-11.999095896021046-16.197465465617256i
-3.172132766947323-47.11460117328156i
32.19080241039254+35.54159456589316i
13.534937590299652+24.705619530444128i
-16.964489054325416-5.233188232227516i
-58.791472918834785-38.557395539863066i
-58.347518112063256+34.2809237345398i
-58.34751811206327-34.28092373453978i
-58.79147291883477+38.55739553986308i
-16.964489054325405+5.233188232227523i
13.53493759029964-24.70561953044414i
32.19080241039254-35.54159456589318i
-3.1721327669473087+47.11460117328156i
-11.99909589602105+16.19746546561725i
-24.451031252500353+115.4254874198877i

=== Forward === 
Doing 8x 4-point FFT in the rows
  strided fft: 32, 8, 0
  strided fft: 16, 8, 0
  strided fft: 8, 8, 0
  strided fft: 8, 8, 0
  strided fft: 16, 8, 0
  strided fft: 8, 8, 0
  strided fft: 8, 8, 0
[(52+0i), 5, 3, 6, 17, 4, 18, 22, (-16.0+0.0i), 27, 2, 3, 5, 31, 41, 16, (-16.0-16.0i), 18, 19, 20, 21, 22, 23, 24, (-15.999999999999998+16.0i), 26, 27, 28, 29, 30, 31, 32]
  strided fft: 32, 8, 1
  strided fft: 16, 8, 1
  strided fft: 8, 8, 1
  strided fft: 8, 8, 1
  strided fft: 16, 8, 1
  strided fft: 8, 8, 1
  strided fft: 8, 8, 1
[(52+0i), (76+0i), 3, 6, 17, 4, 18, 22, (-16.0+0.0i), (-30.0+0.0i), 2, 3, 5, 31, 41, 16, (-16.0-16.0i), (-13.0+1.0i), 19, 20, 21, 22, 23, 24, (-15.999999999999998+16.0i), (-13.0-1.0i), 27, 28, 29, 30, 31, 32]
  strided fft: 32, 8, 2
  strided fft: 16, 8, 2
  strided fft: 8, 8, 2
  strided fft: 8, 8, 2
  strided fft: 16, 8, 2
  strided fft: 8, 8, 2
  strided fft: 8, 8, 2
[(52+0i), (76+0i), (51+0i), 6, 17, 4, 18, 22, (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), 3, 5, 31, 41, 16, (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), 20, 21, 22, 23, 24, (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), 28, 29, 30, 31, 32]
  strided fft: 32, 8, 3
  strided fft: 16, 8, 3
  strided fft: 8, 8, 3
  strided fft: 8, 8, 3
  strided fft: 16, 8, 3
  strided fft: 8, 8, 3
  strided fft: 8, 8, 3
[(52+0i), (76+0i), (51+0i), (57+0i), 17, 4, 18, 22, (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), (-5.0+0.0i), 5, 31, 41, 16, (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), (-14.000000000000002-25.0i), 21, 22, 23, 24, (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), (-13.999999999999998+25.0i), 29, 30, 31, 32]
  strided fft: 32, 8, 4
  strided fft: 16, 8, 4
  strided fft: 8, 8, 4
  strided fft: 8, 8, 4
  strided fft: 16, 8, 4
  strided fft: 8, 8, 4
  strided fft: 8, 8, 4
[(52+0i), (76+0i), (51+0i), (57+0i), (72+0i), 4, 18, 22, (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), (-5.0+0.0i), (4.0+0.0i), 31, 41, 16, (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), (-14.000000000000002-25.0i), (-4.000000000000002-24.0i), 22, 23, 24, (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), (-13.999999999999998+25.0i), (-3.9999999999999987+24.0i), 30, 31, 32]
  strided fft: 32, 8, 5
  strided fft: 16, 8, 5
  strided fft: 8, 8, 5
  strided fft: 8, 8, 5
  strided fft: 16, 8, 5
  strided fft: 8, 8, 5
  strided fft: 8, 8, 5
[(52+0i), (76+0i), (51+0i), (57+0i), (72+0i), (87+0i), 18, 22, (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), (-5.0+0.0i), (4.0+0.0i), (-35.0+0.0i), 41, 16, (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), (-14.000000000000002-25.0i), (-4.000000000000002-24.0i), (-18.0+1.0i), 23, 24, (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), (-13.999999999999998+25.0i), (-3.9999999999999987+24.0i), (-18.0-1.0i), 31, 32]
  strided fft: 32, 8, 6
  strided fft: 16, 8, 6
  strided fft: 8, 8, 6
  strided fft: 8, 8, 6
  strided fft: 16, 8, 6
  strided fft: 8, 8, 6
  strided fft: 8, 8, 6
[(52+0i), (76+0i), (51+0i), (57+0i), (72+0i), (87+0i), (113+0i), 22, (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), (-5.0+0.0i), (4.0+0.0i), (-35.0+0.0i), (-31.0+0.0i), 16, (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), (-14.000000000000002-25.0i), (-4.000000000000002-24.0i), (-18.0+1.0i), (-4.999999999999999+10.0i), 24, (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), (-13.999999999999998+25.0i), (-3.9999999999999987+24.0i), (-18.0-1.0i), (-5.000000000000001-10.0i), 32]
  strided fft: 32, 8, 7
  strided fft: 16, 8, 7
  strided fft: 8, 8, 7
  strided fft: 8, 8, 7
  strided fft: 16, 8, 7
  strided fft: 8, 8, 7
  strided fft: 8, 8, 7
[(52+0i), (76+0i), (51+0i), (57+0i), (72+0i), (87+0i), (113+0i), (94+0i), (-16.0+0.0i), (-30.0+0.0i), (-7.0+0.0i), (-5.0+0.0i), (4.0+0.0i), (-35.0+0.0i), (-31.0+0.0i), (-2.0+0.0i), (-16.0-16.0i), (-13.0+1.0i), (-16.0-25.0i), (-14.000000000000002-25.0i), (-4.000000000000002-24.0i), (-18.0+1.0i), (-4.999999999999999+10.0i), (-2.000000000000001-16.0i), (-15.999999999999998+16.0i), (-13.0-1.0i), (-15.999999999999998+25.0i), (-13.999999999999998+25.0i), (-3.9999999999999987+24.0i), (-18.0-1.0i), (-5.000000000000001-10.0i), (-1.9999999999999991+16.0i)]
52+0i
76+0i
51+0i
57+0i
72+0i
87+0i
113+0i
94+0i
-16.0+0.0i
-30.0+0.0i
-7.0+0.0i
-5.0+0.0i
4.0+0.0i
-35.0+0.0i
-31.0+0.0i
-2.0+0.0i
-16.0-16.0i
-13.0+1.0i
-16.0-25.0i
-14.000000000000002-25.0i
-4.000000000000002-24.0i
-18.0+1.0i
-4.999999999999999+10.0i
-2.000000000000001-16.0i
-15.999999999999998+16.0i
-13.0-1.0i
-15.999999999999998+25.0i
-13.999999999999998+25.0i
-3.9999999999999987+24.0i
-18.0-1.0i
-5.000000000000001-10.0i
-1.9999999999999991+16.0i

0 Matrix 0,0 (0) (which is really 0,0 (0), twiddle: 1.0+0.0i
0 Matrix 0,1 (1) (which is really 0,1 (1), twiddle: 1.0+0.0i
0 Matrix 0,2 (2) (which is really 0,2 (2), twiddle: 1.0+0.0i
0 Matrix 0,3 (3) (which is really 0,3 (3), twiddle: 1.0+0.0i
0 Matrix 0,4 (4) (which is really 0,4 (4), twiddle: 1.0+0.0i
0 Matrix 0,5 (5) (which is really 0,5 (5), twiddle: 1.0+0.0i
0 Matrix 0,6 (6) (which is really 0,6 (6), twiddle: 1.0+0.0i
0 Matrix 0,7 (7) (which is really 0,7 (7), twiddle: 1.0+0.0i

0 Matrix 1,0 (8) (which is really 2,0 (16), twiddle: 1.0+0.0i
2 Matrix 1,1 (9) (which is really 2,1 (17), twiddle: 0.9238795325112867+0.3826834323650898i
4 Matrix 1,2 (10) (which is really 2,2 (18), twiddle: 0.7071067811865476+0.7071067811865475i
6 Matrix 1,3 (11) (which is really 2,3 (19), twiddle: 0.38268343236508984+0.9238795325112867i
8 Matrix 1,4 (12) (which is really 2,4 (20), twiddle: 6.123233995736766e-17+1.0i
10 Matrix 1,5 (13) (which is really 2,5 (21), twiddle: -0.3826834323650897+0.9238795325112867i
12 Matrix 1,6 (14) (which is really 2,6 (22), twiddle: -0.7071067811865475+0.7071067811865476i
14 Matrix 1,7 (15) (which is really 2,7 (23), twiddle: -0.9238795325112867+0.3826834323650899i

0 Matrix 2,0 (16) (which is really 1,0 (8), twiddle: 1.0+0.0i
1 Matrix 2,1 (17) (which is really 1,1 (9), twiddle: 0.9807852804032304+0.19509032201612825i
2 Matrix 2,2 (18) (which is really 1,2 (10), twiddle: 0.9238795325112867+0.3826834323650898i
3 Matrix 2,3 (19) (which is really 1,3 (11), twiddle: 0.8314696123025452+0.5555702330196022i
4 Matrix 2,4 (20) (which is really 1,4 (12), twiddle: 0.7071067811865476+0.7071067811865475i
5 Matrix 2,5 (21) (which is really 1,5 (13), twiddle: 0.5555702330196023+0.8314696123025452i
6 Matrix 2,6 (22) (which is really 1,6 (14), twiddle: 0.38268343236508984+0.9238795325112867i
7 Matrix 2,7 (23) (which is really 1,7 (15), twiddle: 0.19509032201612833+0.9807852804032304i

0 Matrix 3,0 (24) (which is really 3,0 (24), twiddle: 1.0+0.0i
3 Matrix 3,1 (25) (which is really 3,1 (25), twiddle: 0.8314696123025452+0.5555702330196022i
6 Matrix 3,2 (26) (which is really 3,2 (26), twiddle: 0.38268343236508984+0.9238795325112867i
9 Matrix 3,3 (27) (which is really 3,3 (27), twiddle: -0.1950903220161282+0.9807852804032304i
12 Matrix 3,4 (28) (which is really 3,4 (28), twiddle: -0.7071067811865475+0.7071067811865476i
15 Matrix 3,5 (29) (which is really 3,5 (29), twiddle: -0.9807852804032304+0.1950903220161286i
*** CONJUGATE 18 Matrix 3,6 (30) (which is really 3,6 (30), twiddle: -0.9238795325112868-0.38268343236508967i
*** CONJUGATE 21 Matrix 3,7 (31) (which is really 3,7 (31), twiddle: -0.5555702330196022-0.8314696123025452i

52.0+0.0i
76.0+0.0i
51.0+0.0i
57.0+0.0i
72.0+0.0i
87.0+0.0i
113.0+0.0i
94.0+0.0i
-16.0+0.0i
-27.716385975338603-11.480502970952694i
-4.949747468305833-4.949747468305832i
-1.9134171618254492-4.619397662556434i
2.4492935982947064e-16+4.0i
13.39392013277814-32.335783637895034i
21.920310216782973-21.920310216782976i
1.8477590650225735-0.7653668647301798i
-16.0-16.0i
-12.945298967258124-1.5553889058064367i
-5.214986711053344-29.219923230623607i
2.2486812532544196-28.564723569838062i
14.142135623730947-19.798989873223334i
-10.831733806655386-14.41088278842621i
-11.152212486938316-0.7925633389055347i
15.302383842419431-5.0830157130645155i
-15.999999999999998+16.0i
-10.253534726913486-8.053882641557374i
-29.219923230623607-5.21498671105334i
-21.788367501854967-18.60825197604843i
-14.142135623730955-19.798989873223327i
17.849225369274276-2.5308405158870846i
0.7925633389055382+11.152212486938316i
14.414654262879928-7.226184503708545i
Doing 4x 8-point FFT in the rows
602.0+0.0i
-26.0+0.0i
-40.0+12.0i
-40.0-12.0i
-1.6152236891497687-95.94112549695429i
-38.38477631085024-28.058874503045715i
-38.38477631085024+28.058874503045722i
-1.6152236891497544+95.94112549695427i
-13.4175611908862-72.07110882122315i
15.358686687840478+26.33099345104553i
5.460959333083977+16.61324993933122i
-71.40208483003825+45.1268654308464i
-71.40208483003826-45.126865430846394i
5.460959333083977-16.61324993933122i
15.358686687840473-26.33099345104554i
-13.417561190886188+72.07110882122315i
-24.451031252500375-115.4254874198877i
-11.99909589602105-16.197465465617256i
-3.1721327669473283-47.11460117328156i
32.19080241039254+35.54159456589316i
13.534937590299656+24.705619530444128i
-16.964489054325405-5.233188232227519i
-58.791472918834785-38.557395539863066i
-58.347518112063256+34.2809237345398i
-58.34751811206327-34.28092373453978i
-58.79147291883477+38.55739553986308i
-16.964489054325398+5.233188232227528i
13.534937590299633-24.70561953044413i
32.19080241039253-35.541594565893185i
-3.1721327669473123+47.11460117328155i
-11.999095896021057+16.197465465617242i
-24.451031252500332+115.42548741988772i


